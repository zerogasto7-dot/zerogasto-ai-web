<script type="module">
    <div class="flex gap-2 mb-3 justify-center">
    <button onclick="setQuery('Tengo 10 min y: ')" class="text-[11px] bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full hover:bg-emerald-200 border border-emerald-200 transition">âš¡ 10 min</button>
    <button onclick="setQuery('Tengo 30 min y: ')" class="text-[11px] bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full hover:bg-emerald-200 border border-emerald-200 transition">ğŸ³ 30 min</button>
    <button onclick="setQuery('Tengo sobras de: ')" class="text-[11px] bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full hover:bg-emerald-200 border border-emerald-200 transition">â™»ï¸ Aprovechar</button>
</div>
    import { GoogleGenerativeAI } from "@google/generative-ai";

    // 1. ConfiguraciÃ³n de API (Verifica que sea la de AI Studio)
    const API_KEY = 'AIzaSyBH8FjvJN8w3_wwKcPhy9xu5cp84lWaMNM'; 
    const genAI = new GoogleGenerativeAI(API_KEY);

    // 2. DefiniciÃ³n del "Cerebro" (System Prompt)
    const instructions = `Eres 'ZeroGasto AI', un sistema de inteligencia culinaria experto en ahorro.
    TU MISIÃ“N: Crear recetas con lo mÃ­nimo posible para evitar desperdicio.
    TU ESTILO: Directo, motivador y eficiente.
    FORMATO OBLIGATORIO:
    - ğŸ² NOMBRE: [Nombre creativo]
    - â±ï¸ TIEMPO: [Minutos]
    - ğŸ“ PASOS: [MÃ¡ximo 3 pasos numerados]
    - ğŸ’° TIP ZEROGASTO: [Consejo para ahorrar o reutilizar algo]`;

    const model = genAI.getGenerativeModel({ 
        model: "gemini-1.5-flash",
        systemInstruction: instructions
    });

    // Elementos de la interfaz
    const chatContainer = document.getElementById('chat-container');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    let isProcessing = false;

    // FunciÃ³n para los botones rÃ¡pidos
    window.setQuery = function(text) {
        userInput.value = text;
        userInput.focus();
    };

    async function sendMessage() {
        const text = userInput.value.trim();
        if (!text || isProcessing) return;

        isProcessing = true;
        sendBtn.disabled = true;
        appendMessage('user', text);
        userInput.value = '';

        const loadingId = appendMessage('ai', 'Cocinando tu respuesta... â³');

        try {
            const result = await model.generateContent(text);
            const response = await result.response;
            updateMessage(loadingId, response.text());
        } catch (error) {
            console.error("Error:", error);
            updateMessage(loadingId, "âŒ Error de conexiÃ³n. Revisa que tu API Key sea correcta y tengas internet.");
        } finally {
            isProcessing = false;
            sendBtn.disabled = false;
        }
    }

    function appendMessage(role, text) {
        const id = Date.now();
        const msgDiv = document.createElement('div');
        msgDiv.id = id;
        msgDiv.className = role === 'user' 
            ? "bg-emerald-600 text-white p-4 rounded-2xl rounded-tr-none max-w-[85%] ml-auto shadow-sm mb-4"
            : "bg-white border border-emerald-100 text-slate-700 p-4 rounded-2xl rounded-tl-none max-w-[85%] shadow-sm mb-4 whitespace-pre-wrap";
        msgDiv.innerText = text;
        chatContainer.appendChild(msgDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
        return id;
    }

    function updateMessage(id, newText) {
        const msgDiv = document.getElementById(id);
        if (msgDiv) msgDiv.innerText = newText;
    }

    sendBtn.addEventListener('click', sendMessage);
    userInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') sendMessage(); });
</script>
